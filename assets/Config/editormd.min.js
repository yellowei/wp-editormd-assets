!function(s,l,e,c){var t,i;function r(e,t){var i;switch(t){case"emojify":i=e+"/assets/Emojify.js/images/basic";break;case"katex":i=e+"/assets/KaTeX";break;case"mermaid":i=e+"/assets/Mermaid";break;case"prismjs":i=e+"/assets/Prism.js";break;case"codemirror":i=e+"/assets/CodeMirror";break;case"marked":i=e+"/assets/Marked"}return i}s(l).ready(function(){var i=null;if(l.getElementById("wp-content-editor-container"))i="wp-content-editor-container";else if(l.getElementById("wp-replycontent-editor-container")&&"on"===c.supportReply)i="wp-replycontent-editor-container";else if(l.getElementById("comment")&&"on"===c.supportComment)i="comment",s("#comment").after("<div id='comment'></div>").remove();else{if(""===c.supportOther)return!1;i=c.supportOther,s("#"+c.supportOther).after("<div id="+c.supportOther+"></div>").remove()}var e,t=["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","code-block","table","datetime","off"!==c.emoji?"emoji":"html-entities","more","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],r=["bold","del","italic","quote","ucwords","uppercase","lowercase","|","link","reference-link","image","code","code-block","table","datetime","off"!==c.emoji?"emoji":"html-entities","|","watch","preview","fullscreen","clear","info"],o=["ucwords","uppercase","lowercase","|","link","reference-link","image","table","datetime","off"!==c.emoji?"emoji":"html-entities","|","watch","preview","fullscreen","info"];switch(i){case"wp-content-editor-container":e=t;break;case"comment":e=r;break;case"wp-replycontent-editor-container":e=o;break;default:e=t}var m=editormd({id:i,path:c.editormdUrl+"/assets/Editormd/lib/",width:"100%",height:"wp-content-editor-container"===i?640:320,syncScrolling:"off"!==c.syncScrolling,watch:"wp-replycontent-editor-container"!==i&&"off"!==c.livePreview,htmlDecode:"off"!==c.htmlDecode,toolbarAutoFixed:!1,toolbar:!0,autoFocus:"comment"!==i,tocm:!1,tocContainer:"off"!==c.toc&&"",tocDropdown:!1,theme:c.theme,previewTheme:c.previewTheme,editorTheme:c.editorTheme,emoji:"off"!==c.emoji,tex:"off"!==c.tex,mind:"off"!==c.mindMap,mermaid:"off"!==c.mermaid,atLink:!1,taskList:"off"!==c.taskList,imageUpload:"off"!==c.imagePasteSM,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"https://sm.ms/api/upload",placeholder:c.placeholderEditor,prismTheme:c.prismTheme,prismLineNumbers:"off"!==c.prismLineNumbers,toolbarIcons:function(){return e},onfullscreen:function(){l.getElementById(i).style.position="fixed",l.getElementById(i).style.zIndex="99999"},onfullscreenExit:function(){l.getElementById(i).style.position="relative",l.getElementById(i).style.zIndex="auto"},onload:function(){if("comment"===i&&s("textarea.editormd-markdown-textarea").attr("name","comment"),"wp-replycontent-editor-container"===i&&s(".reply").click(function(){setTimeout(function(){s(".edit-comments-php .CodeMirror.cm-s-default.CodeMirror-wrap").css("margin-top",s(".editormd-toolbar").height())},100)}),1600===function(){if(this.innerWidth)return this.innerWidth;if(document.documentElement&&document.documentElement.clientWidth)return document.documentElement.clientWidth;if(document.body)return document.body.clientWidth}()){var e=s(".editormd .CodeMirror.CodeMirror-wrap"),t=e.css("margin-top");e.css("margin-top",parseInt(t)-32+"px")}}});if("undefined"!=typeof wp&&void 0!==wp.media){var a=wp.media.editor.insert,n=new TurndownService;wp.media.editor.insert=function(e){var t=n.turndown(e);a(t),m.insertValue(t)}}"on"===c.imagePaste&&s("#"+i).on("paste",function(e){e=e.originalEvent;var t=window.clipboardData||e.clipboardData,i=window.navigator.userAgent;if(e.clipboardData&&e.clipboardData.items&&!(t.items&&2===t.items.length&&"string"===t.items[0].kind&&"file"===t.items[1].kind&&t.types&&2===t.types.length&&"text/plain"===t.types[0]&&"Files"===t.types[1]&&i.match(/Macintosh/i)&&Number(i.match(/Chrome\/(\d{2})/i)[1])<49)){var r,o,a,n=t.items.length;if(0!==n)if(1!==n||"string"!==t.items[0].kind)if(1===n&&"file"===t.items[0].kind){var d=t.items[0].getAsFile();if(0===d.size)return;r=d,o=function(e){var i="!["+c.imgUploading+"]",r="!["+c.imgUploadeFailed+"]",t={action:"imagepaste_action",dataurl:e};if(m.insertValue(i),"on"===c.imagePasteSM){var o=new FormData,a="http:"!==l.location.protocol;o.append("smfile",function(e){var t;t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURI(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([r],{type:i})}(e)),o.append("ssl",a),o.append("format","json"),s.ajax({url:"https://sm.ms/api/upload",type:"POST",processData:!1,contentType:!1,data:o,success:function(e){"success"===e.code?m.setValue(m.getValue().replace(i,"!["+e.data.filename+"]("+e.data.url+")")):m.setValue(m.getValue().replace(i,r+"[ "+e.msg+" ]"))}})}else s.ajax({url:ajaxurl,type:"POST",data:t,success:function(e){var t=JSON.parse(e);t.error?m.setValue(m.getValue().replace(i,r)):m.setValue(m.getValue().replace(i,"![]("+t.url+")"))}})},(a=new FileReader).onload=function(e){o(e.target.result)},a.readAsDataURL(r)}}})}),editormd.codeMirrorURL={url:r(c.editormdUrl,"codemirror")},editormd.markedURL={js:r(c.editormdUrl,"marked")+"/marked.min"},editormd.prismURL={url:r(c.editormdUrl,"prismjs")},editormd.mindMapURL=(t=c.mindMapURL,null!==(i=/\.{1}[a-z]{1,}$/).exec(t)?t.slice(0,i.exec(t).index):t),"on"===c.tex&&(editormd.katexURL={css:r(c.editormdUrl,"katex")+"/katex.min",js:r(c.editormdUrl,"katex")+"/katex.min"}),"on"===c.mermaid&&(editormd.mermaidURL={js:r(c.editormdUrl,"mermaid")+"/mermaid.min"}),"on"===c.emoji&&(editormd.emoji={path:r(c.editormdUrl,"emojify")+"/",ext:".png"})}(window.jQuery,document,window,window.Editormd);